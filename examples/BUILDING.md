# Quick Reference: Building Examples

## DPP Example for ESP32-C6

### ✅ Recommended: Use Standalone Project

This is the only way that currently works for ESP32-C6:

```bash
cd examples/dpp-esp32c6
cargo build --release
espflash flash --monitor target/riscv32imac-unknown-none-elf/release/dpp-esp32c6
```

### ❌ Workspace Build (Doesn't Work for Embedded)

These commands will fail with linker errors:

```bash
# Don't use these for ESP32-C6!
cargo build --example dpp --features esp32c6 -p qp-examples  # ❌ Linker errors
cd examples && cargo build --example dpp --features esp32c6  # ❌ Linker errors
```

**Why?** Embedded targets need linker scripts (memory.x, link.x) that are generated by esp-hal's build.rs in standalone projects.

## Why Two Approaches?

**Workspace Examples** (`examples/dpp.rs`):
- ✅ Single source file
- ✅ Platform via features
- ✅ Easy to maintain
- ⚠️  **Cannot link for embedded** (missing linker scripts, memory.x)
- **Use for**: Source reference, future native examples

**Standalone Projects** (`examples/dpp-esp32c6/`):**
- ✅ Complete board package
- ✅ Proper linker scripts (provided by esp-hal build.rs)
- ✅ Flash directly to hardware
- ✅ **This is what you should use for ESP32-C6**
- ❌ Duplicate code (but necessary for embedded)
- **Use for**: Building and flashing to hardware

## ⚠️ Important Note

**For ESP32-C6 and other embedded targets, use the standalone projects!**

The workspace examples approach doesn't work for no_std embedded targets because:
- Missing memory layout definitions (memory.x)
- Missing linker scripts (link.x from esp-hal)
- Missing interrupt vector setup
- Missing build.rs that generates board-specific files

The workspace examples will be useful for:
- Future native/hosted examples (Linux, Windows)
- Documentation and reference
- Keeping platform-agnostic logic visible

## Adding More Platforms

1. Add feature to `examples/Cargo.toml`:
   ```toml
   [features]
   stm32 = ["dep:stm32-hal", ...]
   ```

2. Add conditional dependencies:
   ```toml
   [dependencies]
   stm32-hal = { version = "...", optional = true }
   ```

3. Use in example:
   ```rust
   #[cfg(feature = "stm32")]
   use stm32_hal::*;
   ```

4. Build:
   ```bash
   cargo build --example dpp --features stm32 -p qp-examples
   ```
